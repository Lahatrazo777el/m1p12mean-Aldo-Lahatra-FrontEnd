<div class=" flex items-center justify-center p-4">
    <div class="bg-white rounded-lg shadow-xl p-8 max-w-md w-full">
      <h1 class="text-3xl font-bold text-center mb-6">Ajouter une facture</h1>
      <div class="text-red-500" *ngIf="errorMsg">{{ errorMsg }}</div>
      <form class="space-y-6" #myForm="ngForm" (ngSubmit)="onSubmit()">
        <div class="space-y-4">
          <label class="block">
            <span class="text-gray-700">Prestation</span>
            <div class="mt-1 flex gap-4">
                <select name="prestation" [(ngModel)]="history.prestationId" required
                class="w-full px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    <option value="" disabled>Choisir une prestation</option>
                    @for (prestation of prestations; track $index) {
        
                        <option [value]="prestation._id">{{prestation.name}}</option>
                    }
                </select>
              
            </div>
          </label>

          <label class="block">
            <span class="text-gray-700">Client</span>
            <select name="client" id="" [(ngModel)]="history.clientId" required  (change)="onClientChange()"
            class="w-full px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                <option value="" disabled>Choisir un client</option>
                @for (client of clients; track client._id) {
    
                    <option [value]="client._id">{{client.name}}</option>
                }
            </select>
          </label>

          <label class="block">
            <span class="text-gray-700">Vehicule</span>
            <select name="client" id="" [(ngModel)]="history.vehiculeId" required
            class="w-full px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                <option value="" disabled>Choisir un véhicule</option>
                @for (vehicule of vehiculeClient; track vehicule._id) {
    
                    <option [value]="vehicule._id">{{vehicule.name}}</option>
                }
            </select>
          </label>

          <label class="block">
            <span class="text-gray-700">Mécanicien</span>
            <select name="mecanicien" id="" [(ngModel)]="history.mecanicienId" required
            class="w-full px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500">
                <option value="" disabled>Choisir un mecanicien</option>
                @for (mecanicien of mecaniciens; track mecanicien._id) {
    
                    <option [value]="mecanicien._id">{{mecanicien.name}}</option>
                }
            </select>
          </label>

        </div>

        <button
          type="submit"
          [disabled]="myForm.invalid"
          class="w-full bg-gray-800 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition-colors duration-200 flex items-center justify-center gap-2"
        >
          Ajouter
        </button>
      </form>
    </div>
  </div>